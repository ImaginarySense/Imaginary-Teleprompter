class CommandsMapping{constructor(e){this.instance=e,this.preventPropagation=!1,this.command=Object.freeze({incVelocity:1,decVelocity:2,iSync:3,sync:4,togglePlay:5,internalPlay:6,internalPause:7,play:8,pause:9,stopAll:10,incFont:11,decFont:12,anchor:13,close:14,restoreEditor:15,resetTimer:16,nextAnchor:17,previousAnchor:18,fastForward:19,rewind:20}),this.mapping={ArrowDown:"incVelocity",ArrowUp:"decVelocity",ArrowRight:"incFont",ArrowLeft:"decFont",Space:"togglePlay",Period:"sync",Backspace:"resetTimer",Home:"previousAnchor",End:"nextAnchor",PageDown:"fastForward",PageUp:"rewind",F6:"clearAllRequest",F5:"refresh",F8:"togglePrompter",F10:"toggleDebug",F11:"toggleFullscreen"},this.actions={incVelocity:{name:"Increase Velocity",method:function(){this.instance.listener({data:{request:this.command.incVelocity}})}.bind(this)},decVelocity:{name:"Decrease Velocity",method:function(){this.instance.listener({data:{request:this.command.decVelocity}})}.bind(this)},incFont:{name:"Increase Font",method:function(){this.instance.listener({data:{request:this.command.incFont}})}.bind(this)},decFont:{name:"Decrease Font",method:function(){this.instance.listener({data:{request:this.command.decFont}})}.bind(this)},togglePlay:{name:"Toggle Play",method:function(){this.instance.listener({data:{request:this.command.togglePlay}})}.bind(this)},sync:{name:"Sync",method:function(){this.instance.listener({data:{request:this.command.sync}})}.bind(this)},resetTimer:{name:"Reset Timer",method:function(){this.instance.listener({data:{request:this.command.resetTimer}})}.bind(this)},previousAnchor:{name:"Previous Anchor",method:function(){this.instance.listener({data:{request:this.command.previousAnchor}})}.bind(this)},nextAnchor:{name:"Next Anchor",method:function(){this.instance.listener({data:{request:this.command.nextAnchor}})}.bind(this)},fastForward:{name:"Fast Forward",method:function(){this.instance.listener({data:{request:this.command.fastForward}})}.bind(this)},rewind:{name:"Rewind",method:function(){this.instance.listener({data:{request:this.command.rewind}})}.bind(this)},clearAllRequest:{name:"Clear All Request",method:function(){this.instance.clearAllRequest()}},togglePrompter:{name:"Toggle Prompter",method:function(){this.instance.togglePrompter()}},toggleFullscreen:{name:"Toggle Fullscreen",method:function(e){e.preventDefault(),this.instance.toggleFullscreen()}},refresh:{name:"Refresh Screen",method:function(){debug?this.instance.refresh():console.log("Debug mode must be active to use 'F5' refresh in Electron. 'F10' enters and leaves debug mode.")}},toggleDebug:{name:"Toggle Debug",method:function(){this.instance.toggleDebug()}}},teleprompter.settings.commandsMapping&&(this.mapping=JSON.parse(teleprompter.settings.commandsMapping))}draw(){for(var e=document.getElementById("v-pills-commandsMappingContent"),t=Object.keys(this.actions),n=0;n<t.length;n++){var i=document.createElement("tr"),o=document.createElement("th");o.classList="col-6";var r=document.createElement("div");r.classList="row text-center";var s=document.createElement("span");s.style="padding: .375rem .75rem;",s.innerHTML=this.actions[t[n]].name,r.appendChild(s),o.appendChild(r),i.appendChild(o),(o=document.createElement("th")).classList="col-6",(r=document.createElement("div")).classList="row justify-content-center";s=document.createElement("div");s.classList="col-6 text-center";var a,l=document.createElement("button");for(a in l.classList="btn btn-outline-primary w-100",l.type="button",l.id="getKey",l.setAttribute("data-action",t[n]),this.mapping)if(this.mapping.hasOwnProperty(a)&&this.mapping[a]===t[n]){l.setAttribute("data-key",a);var d=a.match(/[A-Z]+(?![a-z])|[A-Z]?[a-z]+|\d+/g).join(" ");l.innerHTML=d;break}""===l.innerHTML&&(l.innerHTML="None",l.setAttribute("data-key","none"));var c=function(e){var t=e.target.getAttribute("data-key"),n=e.target.getAttribute("data-action"),i=e.code;this.mapping[e.code]&&this.mapping[e.code]!==n&&(console.log("Already on another action"),e.target.classList="btn btn-outline-danger w-100 commandsButtonTransition",setInterval(function(){e.target.classList="btn btn-outline-primary w-100",e.target.style=""},500),i=t),this.mapping[t]&&delete this.mapping[t],this.mapping[i]=n,teleprompter.settings.commandsMapping=JSON.stringify(this.mapping),e.target.setAttribute("data-key",i);i=i.match(/[A-Z]+(?![a-z])|[A-Z]?[a-z]+|\d+/g).join(" ");e.target.innerHTML=i,document.removeEventListener("keydown",c)}.bind(this);l.addEventListener("focusout",e=>{var t=e.target.getAttribute("data-key").match(/[A-Z]+(?![a-z])|[A-Z]?[a-z]+|\d+/g).join(" ");e.target.innerHTML=t,document.removeEventListener("keydown",c)}),l.onclick=function(t){t.preventDefault(),t.target.focus(),t.target.innerHTML="Press any key",document.addEventListener("keydown",e=>{e.preventDefault(),c({target:t.target,code:e.code})})},s.appendChild(l),r.appendChild(s),o.appendChild(r),i.appendChild(o),e.appendChild(i)}}}class Controls{constructor(){this.controls={primary:1,secondary:0,prompterStyle:1,focus:0,speed:4,acceleration:1.45,fontSize:120,promptWidth:84,timer:!0,textAtFocusArea:0},this.defaultsQuickConfig={primaryQuick:!0,secondaryQuick:!0,prompterStyleQuick:!0,focusQuick:!0,speedQuick:!0,accelerationQuick:!1,fontSizeQuick:!0,promptWidthQuick:!0,timerQuick:!0},this.setDefaultValues()}setDefaultValues(){for(var e in this.controls)teleprompter.settings[e]||(teleprompter.settings[e]=this.controls[e]);for(var e in this.defaultsQuickConfig)teleprompter.settings[e]||(teleprompter.settings[e]=this.defaultsQuickConfig[e])}draw(){this.slider=[new Slider("#speed",{}),new Slider("#acceleration",{}),new Slider("#fontSize",{}),new Slider("#promptWidth",{}),new Slider("#speedControl",{}),new Slider("#accelerationControl",{}),new Slider("#fontSizeControl",{}),new Slider("#promptWidthControl",{})],this.slider[0].on("change",function(e){teleprompter.settings.speed=parseFloat(Math.round(10*e.newValue)/10).toFixed(1),document.getElementById("speedValue").textContent=teleprompter.settings.speed}),this.slider[1].on("change",function(e){teleprompter.settings.acceleration=parseFloat(Math.round(100*e.newValue)/100).toFixed(2),document.getElementById("accelerationValue").textContent=teleprompter.settings.acceleration}),this.slider[2].on("change",function(e){teleprompter.settings.fontSize=e.newValue,document.getElementById("fontSizeValue").textContent=teleprompter.settings.fontSize,teleprompter.editor.updateFont(teleprompter.settings.fontSize)}),this.slider[3].on("change",function(e){teleprompter.settings.promptWidth=e.newValue,document.getElementById("promptWidthValue").textContent=teleprompter.settings.promptWidth,teleprompter.editor.updateWidth(teleprompter.settings.promptWidth)}),this.slider[4].on("change",function(e){teleprompter.settings.speed=parseFloat(Math.round(10*e.newValue)/10).toFixed(1),document.getElementById("speedControlValue").textContent=teleprompter.settings.speed}),this.slider[5].on("change",function(e){teleprompter.settings.acceleration=parseFloat(Math.round(100*e.newValue)/100).toFixed(2),document.getElementById("accelerationControlValue").textContent=teleprompter.settings.acceleration}),this.slider[6].on("change",function(e){teleprompter.settings.fontSize=e.newValue,document.getElementById("fontSizeControlValue").textContent=teleprompter.settings.fontSize,teleprompter.editor.updateFont(teleprompter.settings.fontSize)}),this.slider[7].on("change",function(e){teleprompter.settings.promptWidth=e.newValue,document.getElementById("promptWidthControlValue").textContent=teleprompter.settings.promptWidth,teleprompter.editor.updateWidth(teleprompter.settings.promptWidth)}),this.setSliderValue(this.slider[0],teleprompter.settings.speed),this.setSliderValue(this.slider[1],teleprompter.settings.acceleration),this.setSliderValue(this.slider[2],teleprompter.settings.fontSize),this.setSliderValue(this.slider[3],teleprompter.settings.promptWidth),this.setSliderValue(this.slider[4],teleprompter.settings.speed),this.setSliderValue(this.slider[5],teleprompter.settings.acceleration),this.setSliderValue(this.slider[6],teleprompter.settings.fontSize),this.setSliderValue(this.slider[7],teleprompter.settings.promptWidth);var e,t=[];for(e in this.controls){var n=document.getElementById(e),i=Object.keys(this.controls).indexOf(e);if(n&&n.value)n.hasAttribute("data-slider-value")?(n.setAttribute("data-slider-id",i),n.onchange=function(e){this.updateQuickSliderControl(e)}.bind(this)):(n.value=teleprompter.settings[e],n.onchange=function(e){this.updateQuickControl(e)}.bind(this));else{t=document.querySelectorAll('input[name="'+e+'"]'),document.querySelector('input[name="'+e+'"]:checked').value=teleprompter.settings[e];for(var o=0;o<t.length;o++)(n=t[o]).onchange=function(e){this.updateQuickToggleControl(e)}.bind(this)}if(t=[],n=document.getElementById(e+"Control"))n.hasAttribute("data-slider-value")?(n.setAttribute("data-slider-id",i),n.onchange=function(e){this.updateSliderControl(e)}.bind(this)):(n.value=teleprompter.settings[e],n.onchange=function(e){this.updateControl(e)}.bind(this));else{t=document.querySelectorAll('input[name="'+e+'Control"]'),document.querySelector('input[name="'+e+'Control"][value="'+("true"===teleprompter.settings[e]?"on":"off")+'"]').checked=!0;for(o=0;o<t.length;o++)(n=t[o]).onchange=function(e){this.updateToggleControl(e)}.bind(this)}(n=document.getElementById(e+"QuickConfig"))&&(n.onchange=function(e){this.updateQuickControlConfig(e)}.bind(this))}this.updateQuickConfig()}updateQuickConfig(){var e,t;for(t in this.controls)(e=document.getElementById(t+"Quick"))&&(e.classList.remove("hidden"),"false"===teleprompter.settings[t+"Quick"]&&e.classList.add("hidden")),(e=document.getElementById(t+"QuickConfig"))&&(e.checked="true"===teleprompter.settings[t+"Quick"])}updateControl(e){e.preventDefault();var t=e.target.id.replace("Control",""),n=document.getElementById(t);n&&(teleprompter.settings[t]=e.target.value,n.value=teleprompter.settings[t])}updateQuickControl(e){e.preventDefault();var t=e.target.id,n=document.getElementById(t+"Control");n&&(teleprompter.settings[t]=e.target.value,n.value=teleprompter.settings[t])}updateToggleControl(e){e.preventDefault();var t=e.target.name.replace("Control","");teleprompter.settings[t]="on"===e.target.value,document.querySelector('input[name="'+t+'"][value="'+("true"===teleprompter.settings[t]?"on":"off")+'"]').checked=!0}updateQuickToggleControl(e){e.preventDefault();var t=e.target.name;teleprompter.settings[t]="on"===e.target.value,document.querySelector('input[name="'+t+'Control"][value="'+("true"===teleprompter.settings[t]?"on":"off")+'"]').checked=!0}updateSliderControl(e){var t;e.preventDefault(),this.preventPropagation?this.preventPropagation=!1:(this.preventPropagation=!0,t=e.target.getAttribute("data-slider-id"),(e=this.slider[parseInt(t)-4]).setValue(this.slider[parseInt(t)].getValue()),e._trigger("change",{newValue:this.slider[parseInt(t)].getValue()}))}updateQuickSliderControl(e){var t;e.preventDefault(),this.preventPropagation?this.preventPropagation=!1:(this.preventPropagation=!0,t=e.target.getAttribute("data-slider-id"),(e=this.slider[parseInt(t)]).setValue(this.slider[parseInt(t)-4].getValue()),e._trigger("change",{newValue:this.slider[parseInt(t)].getValue()}))}updateQuickControlConfig(e){e.preventDefault();var t=e.target.id.replace("Config","");teleprompter.settings[t]=e.target.checked,this.updateQuickConfig()}setSliderValue(e,t){e.setValue(t),e._trigger("change",{newValue:t})}}class FileManager{constructor(){this.instructionsLoaded=!0,this.modal=void 0,this.settingsModal=void 0}draw(){this.on("v-pills-scriptsContent",{name:"Files",elementName:"Script",newElementName:"Untitled",dataKey:"IFTeleprompterSideBar",preloadData:[{name:"Instructions",data:"<h3>Welcome to Imaginary Teleprompter!</h3><p>Are you ready to tell a story?</p><br><p>\"Teleprompter\" is the most complete, free software, professional teleprompter for anyone to use. Click on \"Prompt It!\" whenever you're ready and control the speed with the arrow keys.</p><br><h3>Here are some of our features:</h3><ol><li>Control the speed and text-size with the 'Up' and 'Down' arrow keys, the 'W' and 'S' keys or the mouse wheel. You may press 'Spacebar' to pause at anytime.</li><li>Move half a screen backwards or forwards by pressing the 'PageUp' and 'PageDown' keys.</li><li>Dynamically change the font-size by pressing 'Left' and 'Right' or the 'A' and 'D' keys.</li><li>Flip modes allow <em>mirroring</em> the prompter in every possible way.</li><li>You can use one or two instances. Mirror one, monitor on the other one.</li><li><a id=\"5\" name=\"5\">Set almost any key as a <em>marker</em> and instantly jump to any part of the script. Try pressing '5' now!</a></li><li>Different focus areas allow you to easily use Teleprompter with a webcam, a tablet, or professional teleprompter equipment.</li><li>Time your segments with the built in <em>timer</em>. Press 'Backspace' to reset the timer.</li><li><a name data-cke-saved-name src=\"#\">You can also set nameless <em>markers</em> and move accross them using the Home and End buttons.</a></li><li>Tweak the <em>Speed</em>, <em>Acceleration Curve</em> and <em>Font Size</em> settings to fit your hosts' needs.</li><li>Press 'F11' to enter and leave fullscreen.You may fullscreen the text editor for greater concentration.</li><li>The Rich Text Editor, derived from the highly customizable CKeditor, gives unlimited possibilities on what you can prompt.</li><ul>\x3c!-- <li>Add emoticons to indicate feelings and expressions to your hosts.</li>--\x3e<li>You may generate and display mathematical equations using the integrated CodeCogs equation editor.<br><table border=\"1\" cellpadding=\"1\" cellspacing=\"1\"><tbody><tr><td>&nbsp;</td><td><img alt=\"\bg_white huge sum_{heta+Pi }^{80} sin(heta)\" src=\"https://latex.codecogs.com/gif.latex?%5Cdpi%7B300%7D%20%5Cbg_white%20%5Chuge%20%5Csum_%7B%5CTheta&amp;plus;%5CPi%20%7D%5E%7B80%7D%20sin%28%5CTheta%29\" /></td><td>&nbsp;</td></tr></tbody></table></li><li>Insert images from the web or copy and paste them into the prompter.<img alt=\"Picture: Arecibo Sky\" src=\"assets/custom/img/arecibo-sky.jpg\"></li> </ul><li>There are various <em>Prompter Styles</em> to choose from. You may also create your own.</li>\x3c!-- <li>Download our mobile app, <em>Teleprompter X</em>, to remote control Teleprompter instalations.</li> --\x3e<li>Run the \"External prompter\" on a second screen, add new contents into the editor, then \"Update\" your prompter in realtime without having to halt your script.</li><li>Teleprompter works across screens with different resolutions and aspect ratios.</li><li>Using calculus and relative measurement units, Teleprompter is built to age gracefully. Speed and contents remain consistent from your smallest screen up to 4k devices and beyond.</li><li>Animations are hardware accelerated for a smooth scroll. A quad-core computer with dedicated graphics and, at least, 2GB RAM is recommended for optimal results.</li><li>Teleprompter doesn't stretch a lower quality copy of your prompt for monitoring, instead it renders each instance individually at the highest quality possible. You should lower your resolution to increase performance on lower end machines.</li><li>Text can be pasted from other word processors such as Libre Office Writer&trade; and Microsoft Word&reg;.</li><li>All data is managed locally. We retain no user data.</li><li>Use the standalone installation for greater performance and automatic fullscreen prompting.</li><li>The standalone version comes for Linux, OS X, Microsoft Windows and Free BSD.</li><li>Close prompts and return to the editor by pressing 'ESC'.</li></ol><hr><h4>How to use anchor shortcuts:</h4><ol><li>Select a keyword or line you want to jump to on your text in the editor.</li><li>Click on the <strong>Flag Icon</strong> on the editor's tool bar.</li><li>A box named \"Anchor Properties\" should have appeared. Type any single key of your choice and click 'Ok'.<br>Note preassigned keys, such as WASD and Spacebar will be ignored.</li><li>Repeat as many times as you wish.</li><li>When prompting, press on the shortcut key to jump into the desired location.</li></ol><p>###</p>",editable:!1}]}),teleprompter.editor.contentEditor.save=function(){var e;0!=this.currentElement&&((e=this.getElements())[this.currentElement].data=document.getElementById("prompt").innerHTML,this.getSaveMode().setItem(this.getDataKey(),JSON.stringify(e)))}.bind(this),this.selectedElement=function(e){var t=this.getElements();t[this.currentElement].hasOwnProperty("data")?document.getElementById("prompt").innerHTML=t[this.currentElement].data:document.getElementById("prompt").innerHTML="",this.closeModal()}.bind(this),this.addElementEnded=function(e){debug&&console.log(e),this.selectedElement(e)}.bind(this),this.setEvent("input","prompt",function(){teleprompter.editor.contentEditor.save()}),document.querySelector("#fileManagerToggle").onclick=function(e){e.preventDefault(),this.openModal(),teleprompter.editor.contentEditor.save()}.bind(this),document.querySelector("#fileManagerClose").onclick=function(e){this.closeModal()}.bind(this),document.querySelector("#settingsToggle").onclick=function(e){e.preventDefault(),this.settingsModal=new bootstrap.Modal(document.getElementById("settingsModal"),{keyboard:!1,backdrop:"static"}),this.settingsModal.show()}.bind(this),document.querySelector("#settingsClose").onclick=function(e){this.settingsModal.hide()}.bind(this)}closeModal(){this.modal&&(this.modal.hide(),this.modal=void 0),document.getElementById("prompt").focus()}openModal(){this.modal=new bootstrap.Modal(document.getElementById("filesManagerModal"),{keyboard:!1,backdrop:"static"}),this.modal.show()}maxFileSize(){return Math.floor(122.5)}download(e,t){debug&&(console.log("Downloading:"),console.log(e));var n=e.name+"_"+t+".html",t=e.data,e=document.createElement("a");e.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),e.setAttribute("download",n),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}addScript(e){void 0!==e.preventDefault&&e.preventDefault(),debug&&console.log(e);var t=this.getElements(),n=document.getElementById("inputName"),e=document.getElementById("inputID");return 0===n.value.length?(window.alert("Every script needs a title."),void n.focus()):n.value.length>this.maxFileSize()?(window.alert("That filename is too long..."),void n.focus()):(t.push({id:e.value,name:n.value,data:"",editable:!0}),n.value="",e.value="",this.getSaveMode().setItem(this.getDataKey(),JSON.stringify(t)),this.refreshElements(),new bootstrap.Tab(document.getElementById("v-pills-scripts-tab")).show(),this.currentElement=t.length-1,"function"==typeof this.addElementEnded&&this.addElementEnded(t[t.length]),void this.closeModal())}handleFileSelect(e){var t=e.target.files,n=!1,i=new Array;debug&&console.log("Importing files...");for(var o,r,s,a=0;o=t[a];a++)debug&&console.log(a+1),"text/html"===o.type||"text/plain"===o.type?(n=!0,r=escape(o.name),s=new FileReader,debug&&console.log(r),this.getElements(),"text/plain"===o.type&&(s.onload=function(l,d){return function(e){var t=d.getElements(),n=l.name,i=d.createIDTag(n),o=d.maxFileSize();(n=(n=(n=n.slice(0,n.lastIndexOf(".htm"))).slice(0,n.lastIndexOf(".txt"))).slice(0,n.lastIndexOf(".text"))).length>o&&(debug&&console.log("Name will be truncated. Maximum allowed length: "+o+" characters."),alert("The following file's name is too long and will be truncated: "+n),n=n.slice(0,o));for(var r=e.target.result,s="<p>",a=0;a<r.length;a++)"\n"!==r[a]?s+=r[a]:s+="</p>\n<p>";s+="</p>",console.log(s),t.push({id:i,name:n,data:s,editable:!0}),d.getSaveMode().setItem(d.getDataKey(),JSON.stringify(t)),d.refreshElements(),new bootstrap.Tab(document.getElementById("v-pills-scripts-tab")).show(),d.currentElement=t.length-1,"function"==typeof d.addElementEnded&&d.addElementEnded(t[t.length])}}(o,this)),"text/html"===o.type&&(s.onload=function(r,s){return function(e){var t=s.getElements(),n=r.name,i=s.createIDTag(n),o=s.maxFileSize();(n=(n=(n=n.slice(0,n.lastIndexOf(".htm"))).slice(0,n.lastIndexOf(".txt"))).slice(0,n.lastIndexOf(".text"))).length>o&&(debug&&console.log("Name will be truncated. Maximum allowed length: "+o+" characters."),alert("The following file's name is too long and will be truncated: "+n),n=n.slice(0,o)),t.push({id:i,name:n,data:e.target.result,editable:!0}),s.getSaveMode().setItem(s.getDataKey(),JSON.stringify(t)),s.refreshElements(),s.currentElement=t.length-1,"function"==typeof s.addElementEnded&&s.addElementEnded(t[t.length])}}(o,this)),s.readAsText(o)):o.name.endsWith(".rtf")?(n=!0,(s=new FileReader).onload=function(l,d){return function(e){var t=d.getElements(),n=l.name,i=d.createIDTag(n),o=d.maxFileSize();(n=n.slice(0,n.lastIndexOf(".rtf"))).length>o&&(debug&&console.log("Name will be truncated. Maximum allowed length: "+o+" characters."),alert("The following file's name is too long and will be truncated: "+n),n=n.slice(0,o));var r=e.target.result,s="<p>";r=(r=(r=(r=r.replace(/\\pict([^]+?)\\par/g,"")).replace(/\\par[d]?/g,"")).replace(/\{\*?\\[^{}]+}|[{}]|\\\n?[A-Za-z]+\n?(?:-?\d+)?[ ]?/g,"")).replace(/\\'[0-9a-zA-Z]{2}/g,"").trim();for(var a=0;a<r.length;a++)"\n"!==r[a]?s+=r[a]:s+="</p>\n<p>";t.push({id:i,name:n,data:s+="</p>",editable:!0}),d.getSaveMode().setItem(d.getDataKey(),JSON.stringify(t)),d.refreshElements(),d.currentElement=t.length-1,"function"==typeof d.addElementEnded&&d.addElementEnded(t[t.length])}}(o,this),s.readAsText(o)):i.push(escape(o.name));var l=i.length-1;if(-1!=l){for(var d="The following files could not be imported: ",a=0;a<l;a++)d+=i[a]+", ";d+=i[l]+".",alert(d)}i=null,n||alert("Import failed. No supported file found.")}on(e,t){return this.menu=e,null!=t&&(t.hasOwnProperty("name")&&this.setName(t.name),t.hasOwnProperty("dataKey")&&this.setDataKey(t.dataKey),t.hasOwnProperty("saveMode")&&this.setSaveMode(t.saveMode),t.hasOwnProperty("addElementName")&&this.setAddElementName(t.addElementName),t.hasOwnProperty("elementName")&&this.setNewElementName(t.elementName),t.hasOwnProperty("preloadData")&&t.preloadData.constructor===Array&&this.setPreloadData(t.preloadData)),this.load(),this}load(){this.currentElement=0,this.refreshElements(),this.loadDialog()}loadDialog(){var e=document.getElementById("v-pills-menuContent"),t=document.createElement("input");t.id="files",t.setAttribute("type","file"),t.setAttribute("name","files[]"),t.setAttribute("multiple",""),t.setAttribute("readonly",""),t.setAttribute("tabindex","0"),t.addEventListener("change",this.handleFileSelect.bind(this),!1),t.style.display="none",e.appendChild(t),document.getElementById("v-pills-import-tab").onclick=function(e){t.click()}.bind(this),document.getElementById("inputName").oninput=function(e){document.getElementById("inputID").value=this.createIDTag(document.getElementById("inputName").value)}.bind(this)}getIDs(){for(var e=this.getElements(),t=[],n=0;n<e.length;n++)t.push(e[n].id);return t}createIDTag(e,t){var n="id"+(e=e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})).replace(/\s/g,"");if(void 0===t||0==t){var i=this.getIDs();if(-1!=i.indexOf(n))for(var o=n.replace(/-\d+$/,""),r=i[o]||1;n=o+"-"+r++,-1!=i.indexOf(n););}return n}instructionsAreLoaded(){return this.instructionsLoaded}setEvent(e,t,n){document.getElementById(t).addEventListener(e,function(e){n(e.target),this.refreshElements()}.bind(this))}setSaveMode(e){this.saveMode="sessionStorage"===e?sessionStorage:localStorage}getSaveMode(){return void 0!==this.saveMode&&null!==this.saveMode?this.saveMode:localStorage}setName(e){this.name=e}getName(){return void 0!==this.name&&null!==this.name?this.name:this.menu}setAddElementName(e){this.elementName=e}getAddElementName(){return void 0!==this.elementName&&null!==this.elementName?" Add "+this.elementName:" Add "+this.getName()}getImportElementName(){return void 0!==this.elementName&&null!==this.elementName?" Import "+this.elementName:" Import "+this.getName()}setNewElementName(e){this.newElementName=e}getNewElementName(){return void 0!==this.newElementName&&null!==this.newElementName?this.newElementName:"New "+this.getName()}getElements(){var e=this.getSaveMode().getItem(this.getDataKey());return null==e||0==JSON.parse(e).length?this.getPreloadData():JSON.parse(e)}setDataKey(e){this.dataKey=e}getDataKey(){return this.dataKey||"SideBar"+this.menu}setPreloadData(e){this.preloadData=[];for(var t={},n=0;n<e.length;n++)e[n].hasOwnProperty("id")?(t.id=e[n].id,e[n].hasOwnProperty("name")?t.name=e[n].name:t.name="",e[n].hasOwnProperty("data")?t.data=e[n].data:t.data="",e[n].hasOwnProperty("editable")?t.editable=e[n].editable:t.editable=!0,this.preloadData.push(t)):e[n].hasOwnProperty("name")&&(t.id=this.createIDTag(e[n].name),t.name=e[n].name,e[n].hasOwnProperty("data")?t.data=e[n].data:t.data="",e[n].hasOwnProperty("editable")?t.editable=e[n].editable:t.editable=!0,this.preloadData.push(t))}getPreloadData(){return void 0!==this.preloadData&&null!==this.preloadData?this.preloadData:[]}getCurrentElementIndex(){return this.currentElement}refreshElements(){window.setTimeout(function(){this.clearElements()}.bind(this),1),window.setTimeout(function(){this.addElements()}.bind(this),2)}exitEditMode(){}clearElements(){document.getElementById(this.menu).innerHTML=""}deleteElement(n){this.closeModal(),this.fileManagerDeleteModal=new bootstrap.Modal(document.getElementById("fileManagerDeleteModal"),{keyboard:!1,backdrop:"static"}),this.fileManagerDeleteModal.show(),document.getElementById("fileManagerDeleteModalCancel").onclick=function(e){this.fileManagerDeleteModal.hide(),this.openModal()}.bind(this),document.getElementById("fileManagerDeleteModalDelete").onclick=function(e){var t=this.getElements();t.splice(this.getElementIndexByID(n),1),this.currentElement=t.length-1,this.getSaveMode().setItem(this.getDataKey(),JSON.stringify(t)),this.refreshElements(),this.selectedElement(null),this.fileManagerDeleteModal.hide(),this.openModal()}.bind(this)}getElementIndexByID(e){for(var t=this.getElements(),n=0;n<t.length;n++)if(t[n].id==e)return n}setInstructions(){0===this.currentElement?this.instructionsLoaded=!0:this.instructionsLoaded=!1}addElements(){var r=this.getElements(),e=document.getElementById(this.menu);this.setInstructions();for(var t=0;t<r.length;t++){var n=document.createElement("tr");n.id=r[t].id;var i=document.createElement("th");i.onclick=function(e){e.stopImmediatePropagation();var t,n,i=!1,o=void 0;"textBlock"===e.target.id?(t=e.target.parentNode.parentNode.parentNode.parentNode,n=e.target):"I"===e.target.nodeName?n=(t=e.target.parentNode.parentNode.parentNode.parentNode).querySelector("#textBlock"):"DIV"===e.target.nodeName&&(n=(t=e.target.parentNode.parentNode).querySelector("#textBlock")),t&&(o=t.id,i=n.disabled),i&&(this.currentElement=this.getElementIndexByID(o),this.setInstructions(),r=this.getElements(),"function"==typeof this.selectedElement&&this.selectedElement(r[this.currentElement]))}.bind(this);var o=document.createElement("div");o.classList="row align-items-center";var s=document.createElement("div");s.classList="col-auto";var a=document.createElement("i");a.classList="bi bi-file-earmark-easel-fill",s.appendChild(a),o.appendChild(s),(s=document.createElement("div")).classList="col-auto";var l=document.createElement("input");l.id="textBlock",l.classList="form-control",l.value=r[t].name,l.disabled=!0,s.appendChild(l),o.appendChild(s),i.appendChild(o),n.appendChild(i),0!==t?(i=document.createElement("th"),(o=document.createElement("div")).classList="row align-items-center",(s=document.createElement("div")).classList="col-auto",s.style="padding: .375rem .75rem;",(l=document.createElement("span")).id="editMode",l.setAttribute("tabindex","0"),(a=document.createElement("i")).classList="bi bi-pencil",l.appendChild(a),l.onclick=function(e){e.stopImmediatePropagation(),this.exitEditMode(),e.target.parentNode.style.display="none",e.target.parentNode.parentNode.querySelector("#deleteMode").style.display="";e=e.target.parentNode.parentNode.parentNode.parentNode.parentNode.querySelector("#textBlock");return e.disabled=!1,e.onkeydown=function(e){if(13!=e.keyCode)return 8==e.keyCode&&e.target.value.length-1==0&&(e.target.value="&nbsp;"),!0;if(e.stopImmediatePropagation(),e.target.value.length>this.maxFileSize())return!1;var t=e.target.value.replace("&nbsp;","");return 0<(t=t.replace("<br>","")).length&&(e.target.value=t,r[this.getElementIndexByID(e.target.parentNode.parentNode.parentNode.parentNode.id)].name=t,this.getSaveMode().setItem(this.getDataKey(),JSON.stringify(r)),e.target.parentNode.parentNode.parentNode.parentNode.querySelector("#editMode").style.display="",e.target.parentNode.parentNode.parentNode.parentNode.querySelector("#deleteMode").style.display="none",e.target.disabled=!0)}.bind(this),!1}.bind(this),s.appendChild(l),(l=document.createElement("span")).id="deleteMode",l.setAttribute("tabindex","0"),(a=document.createElement("i")).classList="bi bi-file-earmark-minus",l.appendChild(a),l.onclick=function(e){e.stopImmediatePropagation(),this.deleteElement(e.target.parentNode.parentNode.parentNode.parentNode.parentNode.id),window.setTimeout(function(){this.refreshElements()}.bind(this),1)}.bind(this),l.style.display="none",s.appendChild(l),(l=document.createElement("span")).id="download",l.setAttribute("tabindex","0"),(a=document.createElement("i")).classList="bi bi-cloud-download",l.appendChild(a),l.onclick=function(e){e.stopImmediatePropagation(),this.currentElement=this.getElementIndexByID(e.target.parentNode.parentNode.parentNode.parentNode.parentNode.id),r=this.getElements(),"function"==typeof this.selectedElement&&this.download(r[this.currentElement],this.currentElement)}.bind(this),s.appendChild(l),o.appendChild(s),i.appendChild(o)):i=document.createElement("th"),n.appendChild(i),e.appendChild(n)}document.getElementById("addScriptSidebarButton").onclick=this.addScript.bind(this)}}class Editor{constructor(){this.debug=!1,this.contentEditor={};var e;this.currentEditor="ckeditor",inElectron()&&(e=require("electron"),this.remote=require("@electron/remote"),this.electronScreen=this.remote.screen,this.ipcRenderer=e.ipcRenderer),this.syncMethods={instance:0,canvas:1,follow:2},this.syncMethod=this.syncMethods.instance,this.forceSecondaryDisplay=!1,this.instance=[!1,!1],this.editorFocused=!1,this.syncMethod===this.syncMethods.canvas&&(this.forceSecondaryDisplay=!0)}init(){var n;this.tic=!1,teleprompter.fileManager=new FileManager,teleprompter.commandsMapping=new CommandsMapping(this),teleprompter.themes=new Themes,teleprompter.themes.setColorPicker(),teleprompter.controls=new Controls,this.promptIt=document.getElementById("promptIt"),this.updateIt=document.getElementById("updateIt"),this.promptCanSubmitTeleprompter=!0,this.promptIt.onclick=function(e){this.submitTeleprompter(e)}.bind(this),this.updateIt.onclick=function(e){this.updateTeleprompter(e)}.bind(this),document.getElementById("prompterStyle").addEventListener("change",function(e){teleprompter.themes.setStyle(e.target.value)}.bind(this)),document.getElementById("prompterStyleControl").addEventListener("change",function(e){teleprompter.themes.setStyle(e.target.value)}.bind(this)),this.frame=document.getElementById("teleprompterframe"),this.canvas=document.getElementById("telepromptercanvas"),this.canvasContext=this.canvas.getContext("2d"),teleprompter.themes.styleInit(document.getElementById("prompterStyle")),document.getElementById("credits-link").onclick=this.credits,this.setDomain(),inElectron()&&(n=require("deb-version-compare"),dataManager.getItem("IFTeleprompterVersion",function(t){var e;null==t||1==n(currentVersion,t)?(t="0",!isADevVersion(t)&&isADevVersion(currentVersion)?(window.location="#devWarning",(e=document.getElementById("agreeWarningButton")).onclick=function(e){this.applyMigration(t),dataManager.setItem("IFTeleprompterVersion",currentVersion),this.closeModal()}.bind(this),document.getElementById("cancelWarningButton").onclick=this.closeWindow,document.getElementById("closeWarning").onclick=this.closeWindow,e.focus()):(this.applyMigration(t),dataManager.setItem("IFTeleprompterVersion",currentVersion),this.closeModal())):1==n(t,currentVersion)&&(window.location="#devNewestVersion",(e=document.getElementById("cancelNewestButton")).onclick=function(e){this.remote.getCurrentWindow().close()}.bind(this),e.focus())},0,0),this.ipcRenderer.on("asynchronous-reply",function(e,t){if("c"===t.option){resizeCanvas(t.size);var n,i=new Uint8ClampedArray(t.bitmap);try{n=new ImageData(i,t.size[0],t.size[1])}catch(e){n=new ImageData(t.size[0],t.size[1])}requestAnimationFrame(function(){canvasContext.putImageData(n,0,0)})}else if("qr"===t.option)addQRConnection(t.data);else if("restoreEditor"===t.option)this.restoreEditor();else if("command"===t.option)document.onkeydown(t.data);else if("prepareLinks"===t.option)for(var o=document.getElementsByClassName("external"),r=0;r<o.length;r++)" "!=o[r].href&&(o[r].setAttribute("onclick","shell.openExternal('"+o[r].href+"'); return false;"),o[r].href="#",o[r].target="_parent")}),this.ipcRenderer.send("asynchronous-message","prepareLinks")),teleprompter.controls.draw(),teleprompter.themes.draw(),teleprompter.fileManager.draw(),loadScript(`editors/${this.currentEditor}.js`),teleprompter.commandsMapping.draw();var e=document.getElementById("promptcontainer");e.onscroll=function(e){teleprompter.settings.promptStartPosition=e.target.scrollTop},teleprompter.settings.promptStartPosition?e.scrollTop=teleprompter.settings.promptStartPosition:teleprompter.settings.promptStartPosition=0,addEventListener("message",function(e){this.listener(e)}.bind(this),!1);var t=new XMLHttpRequest;t.onreadystatechange=function(){4==t.readyState&&200==t.status&&(this.htmldata=t.responseText,this.internalCredits())}.bind(this),document.addEventListener("keydown",function(e){this.commandsListener(e)}.bind(this)),window.addEventListener("beforeunload",this.updatePrompterData),$(".btn-toggle").click(function(){$(this).find(".btn").toggleClass("active"),0<$(this).find(".btn-primary").length&&$(this).find(".btn").toggleClass("btn-primary"),0<$(this).find(".btn-danger").length&&$(this).find(".btn").toggleClass("btn-danger"),0<$(this).find(".btn-success").length&&$(this).find(".btn").toggleClass("btn-success"),0<$(this).find(".btn-info").length&&$(this).find(".btn").toggleClass("btn-info"),$(this).find(".btn").toggleClass("btn-default")}),$("form").submit(function(){return!1})}closeWindow(){this.remote.getCurrentWindow().close()}resizeCanvas(e){this.canvas.width===e[0]&&this.canvas.height===e[1]||(this.canvas.width=e[0],this.canvas.height=e[1])}isADevVersion(e){return!!(e.includes("rc")||e.includes("alpha")||e.includes("beta"))}applyMigration(e){switch(e){default:case null:case"0":case"2.2.0":dataManager.getItem("IFTeleprompterSideBar",function(e){if(e){0<(e=JSON.parse(e)).length&&(e[0].id=teleprompter.fileManager.createIDTag(e[0].name,!0),teleprompter.fileManager.getSaveMode().setItem(teleprompter.fileManager.getDataKey(),JSON.stringify(e)));for(var t=1;t<e.length;t++)e[t].hasOwnProperty("name")&&(e[t].id=teleprompter.fileManager.createIDTag(e[t].name),teleprompter.fileManager.getSaveMode().setItem(teleprompter.fileManager.getDataKey(),JSON.stringify(e)))}},0,0);case"2.3.0":case"2.4.0":}}setDomain(){this.domain=document.domain,0==this.domain.indexOf("http://")&&0==this.domain.indexOf("https://")&&0==this.domain.indexOf("localhost")||(this.domain="*")}getDomain(){return this.domain}launchIntoFullscreen(e){var t=e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullscreen||e.msRequestFullscreen;void 0!==t&&t.call(e)}exitFullscreen(){var e=document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen;void 0!==e&&e.call(document)}toggleFullscreen(){var e;document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?this.exitFullscreen():(e=this.promptCanSubmitTeleprompter?document.getElementById("editorcontainer"):document.documentElement,this.launchIntoFullscreen(e))}togglePrompter(){this.promptCanSubmitTeleprompter?this.submitTeleprompter():this.restoreEditor()}togglePromptIt(){this.promptCanSubmitTeleprompter?(this.promptIt.textContent="Close It...",this.promptCanSubmitTeleprompter=!1,this.promptIt.onclick=function(e){this.restoreEditor(e)}.bind(this),this.instance[0]?(document.getElementById("content").style.display="none",document.getElementById("editorcontainer").style.display="none",document.getElementById("footer").style.display="none",document.getElementById("framecontainer").style.display="block",this.instance[1]&&this.syncMethod===this.syncMethods.canvas?(this.canvas.style.display="block",this.frame.style.display="none"):(this.frame.style.display="block",this.canvas.style.display="none"),this.launchIntoFullscreen(document.documentElement)):this.instance[1]&&this.updateIt.classList.remove("hidden")):(this.promptIt.innerHTML="Prompt It!",this.promptCanSubmitTeleprompter=!0,this.promptIt.onclick=function(e){this.submitTeleprompter(e)}.bind(this),this.instance[0]?(document.getElementById("content").style.display="",document.getElementById("editorcontainer").style.display="",document.getElementById("footer").style.display="",document.getElementById("framecontainer").style.display="none",this.instance[1]&&this.syncMethod===this.syncMethods.canvas?this.canvas.style.display="none":this.frame.style.display="none",this.exitFullscreen()):this.instance[1]&&this.updateIt.classList.add("hidden"))}internalCredits(){this.instance[0]=!0,this.instance[1]=!1,this.togglePromptIt();var e='{ "html":"'+encodeURIComponent(htmldata)+'" }';dataManager.setItem("IFTeleprompterSettings",'{ "data": {"secondary":0,"primary":1,"prompterStyle":2,"focusMode":3,"background":"#3CC","color":"#333","overlayBg":"#333","speed":"13","acceleration":"1.2","fontSize":"100","promptWidth":"84","timer":"false","voice":"false"}}',1),dataManager.setItem("IFTeleprompterSession",e),this.frame.src="teleprompter.html?debug=1",this.frame.focus()}credits(){var e=new XMLHttpRequest;e.open("GET","credits.html",!0),e.send(),this.toggleFullscreen()}updatePrompterData(){this.htmldata=teleprompter.editor.contentEditor.getEditorContent();var e='{ "html":"'+encodeURIComponent(this.htmldata)+'" }';dataManager.setItem("IFTeleprompterSession",e,1)}restoreEditor(e){this.promptCanSubmitTeleprompter||(debug&&console.log("Restoring editor."),-1!=this.frame.src.indexOf("teleprompter.html")&&this.frame.contentWindow.postMessage({request:teleprompter.commandsMapping.command.close},this.getDomain()),this.prompterWindow&&this.prompterWindow.postMessage({request:teleprompter.commandsMapping.command.close},this.getDomain()),this.syncMethod===this.syncMethods.canvas&&this.ipcRenderer.send("asynchronous-message","closeInstance"),this.frame.src="about:blank",e&&e.preventDefault&&e.preventDefault(),this.togglePromptIt()),promptcontainer.scrollTop=teleprompter.settings.promptStartPosition}submitTeleprompter(e){debug&&console.log("Submitting to prompter"),void 0!==e&&void 0!==e.preventDefault&&e.preventDefault();var t=null;if(this.updatePrompterData(),this.instance[0]=0<teleprompter.settings.primary,this.instance[1]=0<teleprompter.settings.secondary,inElectron()){const o=this.electronScreen.getAllDisplays();var n=this.electronScreen.getPrimaryDisplay(),i=0,e=this.electronScreen.getCursorScreenPoint();debug&&console.log("Displays amount: "+o.length);const t=o.find(e=>0!==e.bounds.x||0!==e.bounds.y);debug&&console.log("Primary display:"),debug&&console.log(n),debug&&console.log("Secondary display:"),debug&&console.log(t),(e.x<n.bounds.x||e.x>n.bounds.width||e.y<n.bounds.y||e.y>n.bounds.height)&&(i=1),this.instance[1]&&(t||this.forceSecondaryDisplay?0===i?(debug&&console.log("Displaying external on secondary display."),this.instance[0]&&this.syncMethod===this.syncMethods.canvas?this.openCanvasPrompter():this.prompterWindow=window.open("teleprompter.html"+(debug?"?debug=1":""),"TelePrompter Output","height="+(t.workArea.height-50)+",width="+(t.workArea.width-50)+",top="+(t.workArea.y+50)+",left="+(t.workArea.x+50)+",fullscreen=0,status=0,location=0,menubar=0,toolbar=0")):0<i&&(debug&&console.log("Displaying external on primary display."),this.instance[0]&&this.syncMethod===this.syncMethods.canvas?this.openCanvasPrompter():this.prompterWindow=window.open("teleprompter.html"+(debug?"?debug=1":""),"TelePrompter Output","height="+(n.workArea.height-50)+",width="+(n.workArea.width-50)+",top="+(n.workArea.y+50)+",left="+(n.workArea.x+50)+",fullscreen=0,status=0,location=0,menubar=0,toolbar=0")):this.instance[0]||(debug&&console.log("Displaying external on primary display."),this.prompterWindow=window.open("teleprompter.html"+(debug?"?debug=1":""),"TelePrompter Output","height="+(n.workArea.height-50)+",width="+(n.workArea.width-50)+",top="+(n.workArea.y+50)+",left="+(n.workArea.x+50)+",fullscreen=0,status=0,location=0,menubar=0,toolbar=0"))),!this.instance[0]||this.instance[1]&&!t||(this.frame.src="teleprompter.html"+(debug?"?debug=1":""))}else this.instance[0]&&(this.frame.src="teleprompter.html"+(debug?"?debug=1":"")),this.instance[1]&&(this.prompterWindow=window.open("teleprompter.html"+(debug?"?debug=1":""),"TelePrompter Output","height="+screen.availHeight+",width="+screen.width+",top=0,left="+screen.width+",fullscreen=0,status=0,location=0,menubar=0,toolbar=0"));(null!=this.prompterWindow&&window.focus?this.prompterWindow:this.frame).focus(),!this.forceSecondaryDisplay&&inElectron()&&!t&&this.instance[0]&&this.instance[1]?(window.alert("You don't have any external Display."),this.instance[0]=!1,this.instance[1]=!1):this.instance[0]||this.instance[1]?this.togglePromptIt():window.alert("You must prompt at least to one display.")}openCanvasPrompter(){debug&&console.log("Opening experimental prompter."),this.ipcRenderer.send("asynchronous-message","openInstance")}updateTeleprompter(e){e.preventDefault(),this.updatePrompterData(),debug&&console.log("Updating prompter contents"),this.listener({data:{request:teleprompter.commandsMapping.command.updateContents}})}toggleDebug(){inElectron()?this.remote.getCurrentWindow().toggleDevTools():this.toggleDebugMode()}toc(){this.tic,this.tic}refresh(){location.reload()}clearAllRequest(){confirm("You've pressed F6. Do you wish to perform a factory reset of Teleprompter? You will loose all saved scripts and custom styles.")&&(dataManager.clearAll(),window.removeEventListener("beforeunload",function(){this.updatePrompterData()}.bind(this)),refresh())}listener(e){e.domain&&e.domain!==this.getDomain()||((e=e.data).request===teleprompter.commandsMapping.command.restoreEditor?this.restoreEditor():this.syncMethod===this.syncMethods.canvas&&this.instance[0]&&this.instance[1]&&inElectron()?this.ipcRenderer.send("asynchronous-message",e):(e.request!==teleprompter.commandsMapping.command.iSync&&e.request!==teleprompter.commandsMapping.command.sync?this.tic?(this.instance[1]&&this.prompterWindow.postMessage(e,this.getDomain()),instance[0]&&this.frame.contentWindow.postMessage(e,this.getDomain())):(this.instance[0]&&this.frame.contentWindow.postMessage(e,this.getDomain()),this.instance[1]&&this.prompterWindow.postMessage(e,this.getDomain())):this.instance[0]&&this.instance[1]&&(this.tic?(this.instance[1]&&this.prompterWindow.postMessage(e,this.getDomain()),this.instance[0]&&this.frame.contentWindow.postMessage(e,this.getDomain())):(this.instance[0]&&this.frame.contentWindow.postMessage(e,this.getDomain()),this.instance[1]&&this.prompterWindow.postMessage(e,this.getDomain()))),setTimeout(this.toc,10)))}commandsListener(e){var t;e.target.hasAttribute("data-key")||((t=teleprompter.commandsMapping.mapping)[e.code]?teleprompter.commandsMapping.actions[t[e.code]].method():e.key&&(e=this.isFunction(e.key.indexOf)?e.key:String.fromCharCode(e.key),this.is_int(e)||(e=e.toLowerCase()),debug&&console.log(e),this.listener({data:{request:teleprompter.commandsMapping.command.anchor,data:e}})))}closeModal(){"openCustomStyles"===window.location.hash.slice(1)?this.closePromptStyles():"devWarning"===window.location.hash.slice(1)?dataManager.getItem("IFTeleprompterVersion",function(e){console.log(e),e===currentVersion?window.location="#close":window.close()},1):window.location="#close",document.getElementById("prompt").focus(),teleprompter.fileManager.modal&&(teleprompter.fileManager.modal.hide(),teleprompter.fileManager.modal=void 0)}updateFont(e){debug&&console.log("Updating font."),document.getElementById("prompt").style.fontSize="calc(5vw * "+e/100+")"}updateWidth(e){debug&&console.log("Updating width.");const t=document.getElementById("prompt");t.style.width=e+"vw",t.style.left="calc("+(50-e/2)+"vw - 14px)"}isFunction(e){return typeof e==typeof Function}is_int(e){return parseFloat(e)==parseInt(e)&&!isNaN(e)}insertTextAtCursor(e){var t;window.getSelection?(t=window.getSelection()).getRangeAt&&t.rangeCount&&((t=t.getRangeAt(0)).deleteContents(),t.insertNode(e)):document.selection&&document.selection.createRange&&(document.selection.createRange().text=text)}toggleDebugMode(){(this.debug?exitDebug:enterDebug)()}}teleprompter.editor=new Editor,"interactive"===document.readyState||"complete"===document.readyState?teleprompter.editor.init():document.addEventListener("DOMContentLoaded",function(){teleprompter.editor.init()}.bind(this));