// Generated by CoffeeScript 1.4.0
var existsSync, fs, path;

fs = require('fs');

path = require('path');

existsSync = fs.existsSync || path.existsSync;

module.exports = {
  flatten: function(arr, ret) {
    var i, _i, _ref;
    if (ret == null) {
      ret = [];
    }
    for (i = _i = 0, _ref = arr.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {
      if (Array.isArray(arr[i])) {
        this.flatten(arr[i], ret);
      } else {
        ret.push(arr[i]);
      }
    }
    return ret;
  },
  workspace: function() {
    var dir, dirs, _i, _len;
    dirs = require('module')._nodeModulePaths(process.argv[1]);
    for (_i = 0, _len = dirs.length; _i < _len; _i++) {
      dir = dirs[_i];
      if (existsSync(dir) || existsSync(path.normalize(dir + '/../package.json'))) {
        return path.normalize(dir + '/..');
      }
    }
  },
  checkPort: function(port, host, callback) {
    var cmd;
    cmd = exec("nc " + host + " " + port + " < /dev/null");
    return cmd.on('exit', function(code) {
      if (code === 0) {
        return callback(true);
      }
      if (code === 1) {
        return callback(false);
      }
      return callback(new Error('The nc (or netcat) utility is required'));
    });
  }
};
